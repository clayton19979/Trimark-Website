<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ore Sites - Trimark Industries</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Load the custom systems data instead of EVE Online systems -->
    <script src="solar-systems-data.js"></script>
    <script>
        // Global variables
        let customSystems = [];
        let allSystems = [];
        let searchTimeout;
        
        // Load systems from embedded JavaScript data
        function loadSystems() {
            try {
                if (customSystems && customSystems.length > 0) {
                    allSystems = customSystems;
                    console.log('‚úÖ Loaded', allSystems.length, 'solar system names from embedded data');
                    console.log('üîç First 10 systems:', allSystems.slice(0, 10));
                    console.log('üîç Last 10 systems:', allSystems.slice(-10));
                    
                    // Check if H:1807 is in the list
                    if (allSystems.includes('H:1807')) {
                        console.log('‚úÖ H:1807 found in systems list');
                    } else {
                        console.log('‚ùå H:1807 NOT found in systems list');
                    }
                } else {
                    // Fallback systems
                    allSystems = [
                        "A 2560", "M 974", "U 3183", "O3H-1FN", "O9T-0FN", "UFC-3FN", 
                        "OR7-5FN", "O71-4FN", "U2L-4FN", "OT4-2FN", "IMP-2FN", "E06-D68"
                    ];
                    console.log('‚ÑπÔ∏è Using fallback systems:', allSystems.length);
                }
            } catch (error) {
                console.error('‚ùå Error loading solar system names:', error);
                allSystems = ["A 2560", "M 974", "U 3183", "O3H-1FN", "O9T-0FN"];
            }
        }
        
        // Load custom systems from embedded JavaScript data
        console.log('üöÄ Starting to load solar system names from embedded data...');
        
        // Check if the solar systems data is available
        if (typeof SOLAR_SYSTEMS !== 'undefined' && Array.isArray(SOLAR_SYSTEMS)) {
            customSystems = SOLAR_SYSTEMS;
            console.log('‚úÖ Loaded solar system names:', customSystems.length);
            console.log('üîç Sample systems:', customSystems.slice(0, 10));
            console.log('üîç Checking for H:1807:', customSystems.includes('H:1807'));
            
            // Now that systems are loaded, initialize the search functionality
            loadSystems();
        } else {
            console.error('‚ùå SOLAR_SYSTEMS not found or not an array');
            // Fallback to some basic systems
            customSystems = ["A 2560", "M 974", "U 3183", "O3H-1FN", "O9T-0FN"];
            console.log('üîÑ Using fallback systems:', customSystems);
            
            // Initialize with fallback systems
            loadSystems();
        }
    </script>
    <style>
        /* Simple Search Styles */
        .search-container {
            position: relative;
            margin: 20px 0;
        }
        
        .search-input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(26, 26, 46, 0.9);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
        }
        
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #1a1a2e;
            border: 1px solid #00d4ff;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            margin-top: 5px;
            display: none;
        }
        
        .search-result-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid rgba(0, 212, 255, 0.2);
            color: #fff;
        }
        
        .search-result-item:hover {
            background: rgba(0, 212, 255, 0.1);
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .ore-form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: rgba(26, 26, 46, 0.8);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 15px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            color: #00d4ff;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 15px;
            background: rgba(26, 26, 46, 0.9);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
        }
        
        .form-select {
            width: 100%;
            padding: 12px 15px;
            background: rgba(26, 26, 46, 0.9);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            color: #fff;
            font-size: 1rem;
        }
        
        .submit-btn {
            background: linear-gradient(135deg, #00d4ff, #0099cc);
            border: none;
            color: #fff;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            width: 100%;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.4);
        }
        
        .test-btn {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            border: none;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
    </style>
</head>
<body>
    <div class="stars"></div>
    <div class="twinkling"></div>
    
    <div class="container">
        <header class="header">
            <div class="logo">
                <div class="logo-image">
                    <img src="ChatGPT_Image_Jul_3_2025_08_34_57_PM.png" alt="Trimark Industries Logo" class="corp-logo">
                </div>
                <div class="logo-text">
                    <h1>TRIMARK INDUSTRIES</h1>
                    <p class="tagline">Forging the Future in EVE Frontier</p>
                </div>
            </div>
            
            <nav class="nav">
                <a href="index.html" class="nav-link">Home</a>
                <a href="about.html" class="nav-link">About</a>
                <a href="ore-sites.html" class="nav-link active">Ore Sites</a>
                <a href="roles.html" class="nav-link">Roles</a>
                <a href="events.html" class="nav-link">Events</a>
                <a href="members.html" class="nav-link">Members</a>
            </nav>
        </header>

        <main class="main-content">
            <section class="ore-section">
                <div class="ore-header">
                    <h2 class="section-title">‚õèÔ∏è Report New Ore Site</h2>
                    <p class="section-subtitle">Help expand our mining operations by reporting new ore sites you discover.</p>
                </div>
                
                <div class="ore-form">
                                         <form id="oreSiteForm">
                         <div class="form-group">
                             <label for="systemName">System Name:</label>
                             <div class="search-container">
                                 <input type="text" id="systemName" class="search-input" placeholder="Type to search for systems..." autocomplete="off">
                                 <div id="searchResults" class="search-results"></div>
                             </div>
                         </div>
                         
                         <div class="form-group">
                             <label for="oreType">Ore Type:</label>
                             <select id="oreType" class="form-select" required>
                                 <option value="">Select Ore Type</option>
                                 <option value="Common Ore">Common Ore</option>
                                 <option value="Carbonaceous Ore">Carbonaceous Ore</option>
                                 <option value="Metal Rich Ore">Metal Rich Ore</option>
                                 <option value="Deep-Core Metallic Ore">Deep-Core Metallic Ore</option>
                                 <option value="Deep-Core Carbon Ore">Deep-Core Carbon Ore</option>
                                 <option value="Core Aestasium">Core Aestasium</option>
                                 <option value="Core Hermetite">Core Hermetite</option>
                                 <option value="Crude Matter">Crude Matter</option>
                                 <option value="Special Materials">Special Materials</option>
                             </select>
                         </div>
                         
                         <div class="form-group">
                             <label for="siteNotes">Additional Notes:</label>
                             <textarea id="siteNotes" class="form-input" rows="3" placeholder="Any additional information about the site..."></textarea>
                         </div>
                         
                         <div class="form-group">
                             <button type="submit" class="submit-btn">Submit Report</button>
                         </div>
                     </form>
                     
                     <div style="text-align: center; margin-top: 20px;">
                         <button onclick="showAllSystems()" class="test-btn">Show All Systems</button>
                         <button onclick="testSystemLoading()" class="test-btn">Test System Loading</button>
                     </div>
                 </div>
             </section>
             
             <!-- View Submitted Ore Sites Section -->
             <section class="ore-section" style="margin-top: 40px;">
                 <div class="ore-header">
                     <h2 class="section-title">üìã View Submitted Ore Sites</h2>
                     <p class="section-subtitle">Browse and manage all reported ore sites.</p>
                 </div>
                 
                 <div class="ore-form">
                     <div class="form-group">
                         <label for="filterSystem">Filter by System:</label>
                         <input type="text" id="filterSystem" class="form-input" placeholder="Type system name to filter...">
                     </div>
                     
                     <div class="form-group">
                         <label for="filterOreType">Filter by Ore Type:</label>
                         <select id="filterOreType" class="form-select">
                             <option value="">All Ore Types</option>
                             <option value="Common Ore">Common Ore</option>
                             <option value="Carbonaceous Ore">Carbonaceous Ore</option>
                             <option value="Metal Rich Ore">Metal Rich Ore</option>
                             <option value="Deep-Core Metallic Ore">Deep-Core Metallic Ore</option>
                             <option value="Deep-Core Carbon Ore">Deep-Core Carbon Ore</option>
                             <option value="Core Aestasium">Core Aestasium</option>
                             <option value="Core Hermetite">Core Hermetite</option>
                             <option value="Crude Matter">Crude Matter</option>
                             <option value="Special Materials">Special Materials</option>
                         </select>
                     </div>
                     
                     <div class="form-group">
                         <button onclick="loadOreSites()" class="submit-btn">Load Ore Sites</button>
                         <button onclick="clearFilters()" class="test-btn" style="margin-left: 10px;">Clear Filters</button>
                     </div>
                     
                     <div id="oreSitesList" class="ore-sites-list">
                         <!-- Ore sites will be displayed here -->
                     </div>
                 </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Initializing ore site system...');
            
            // Set up search input
            const systemInput = document.getElementById('systemName');
            const searchResults = document.getElementById('searchResults');
            
            if (systemInput && searchResults) {
                // Search as user types
                systemInput.addEventListener('input', function() {
                    const query = this.value.trim();
                    
                    // Clear previous timeout
                    if (searchTimeout) {
                        clearTimeout(searchTimeout);
                    }
                    
                    // Search after user stops typing for 300ms
                    searchTimeout = setTimeout(() => {
                        performSearch(query);
                    }, 300);
                });
                
                // Hide results when clicking outside
                document.addEventListener('click', function(e) {
                    if (!systemInput.contains(e.target) && !searchResults.contains(e.target)) {
                        searchResults.style.display = 'none';
                    }
                });
            }
            
            // Set up form submission
            const form = document.getElementById('oreSiteForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const systemName = document.getElementById('systemName').value;
                    const oreType = document.getElementById('oreType').value;
                    const notes = document.getElementById('siteNotes').value;
                    
                    if (!systemName || !oreType) {
                        alert('Please fill in all required fields.');
                        return;
                    }
                    
                    // Check if system exists
                    if (!allSystems.includes(systemName)) {
                        alert('Please select a valid system from the search results.');
                        return;
                    }
                    
                    // Create ore site
                    const oreSite = {
                        id: 'ore_' + Date.now(),
                        system: systemName,
                        oreType: oreType,
                        notes: notes || 'No additional notes.',
                        reportedAt: new Date().toLocaleString()
                    };
                    
                    console.log('‚úÖ New ore site:', oreSite);
                    
                    // Save to localStorage
                    const existingSites = JSON.parse(localStorage.getItem('trimark_ore_sites') || '[]');
                    existingSites.push(oreSite);
                    localStorage.setItem('trimark_ore_sites', JSON.stringify(existingSites));
                    
                    // Reset form
                    form.reset();
                    searchResults.style.display = 'none';
                    
                    alert('Ore site report submitted successfully!');
                });
            }
        });
        
        // Perform search
        function performSearch(query) {
            const searchResults = document.getElementById('searchResults');
            
            if (!query || query.length < 1) {
                searchResults.style.display = 'none';
                return;
            }
            
            console.log('üîç Searching for:', query);
            console.log('üîç Total systems available:', allSystems.length);
            console.log('üîç allSystems type:', typeof allSystems);
            console.log('üîç allSystems sample:', allSystems.slice(0, 5));
            
            const queryLower = query.toLowerCase();
            const results = allSystems.filter(system => 
                system.toLowerCase().includes(queryLower)
            ).slice(0, 10); // Limit to 10 results
            
            console.log('üîç Search results:', results);
            console.log('üîç Results length:', results.length);
            
            if (results.length > 0) {
                searchResults.innerHTML = results.map(system => 
                    `<div class="search-result-item" onclick="selectSystem('${system}')">${system}</div>`
                ).join('');
                searchResults.style.display = 'block';
            } else {
                searchResults.innerHTML = '<div class="search-result-item">No systems found</div>';
                searchResults.style.display = 'block';
            }
        }
        
        // Select a system from search results
        function selectSystem(systemName) {
            document.getElementById('systemName').value = systemName;
            document.getElementById('searchResults').style.display = 'none';
        }
        
        // Test function
        function testSearch() {
            console.log('üß™ Testing search...');
            console.log('üîç Total systems available:', allSystems.length);
            console.log('üîç Sample systems:', allSystems.slice(0, 5));
            
            // Test search for "A" (should find "A 2560", etc.)
            const results = allSystems.filter(system => 
                system.toLowerCase().includes('a')
            ).slice(0, 5);
            
            console.log('üîç Search results for "A":', results);
            
            // Show results in search box
            const searchResults = document.getElementById('searchResults');
            if (results.length > 0) {
                searchResults.innerHTML = results.map(system => 
                    `<div class="search-result-item" onclick="selectSystem('${system}')">${system}</div>`
                ).join('');
                searchResults.style.display = 'block';
            }
        }
        
        // Show all systems
        function showAllSystems() {
            console.log('üîç All custom systems:', allSystems);
            alert(`Total custom systems available: ${allSystems.length}\n\nFirst 10 systems:\n${allSystems.slice(0, 10).join('\n')}`);
        }
        
        // Test system loading
        function testSystemLoading() {
            console.log('üß™ Testing system loading...');
            console.log('üîç customSystems:', customSystems);
            console.log('üîç allSystems:', allSystems);
            console.log('üîç customSystems length:', customSystems ? customSystems.length : 'undefined');
            console.log('üîç allSystems length:', allSystems ? allSystems.length : 'undefined');
            
            // Test specific search
            if (allSystems && allSystems.length > 0) {
                const hResults = allSystems.filter(system => system.toLowerCase().includes('h:18'));
                console.log('üîç Systems containing "h:18":', hResults);
                alert(`Systems found containing "h:18": ${hResults.length}\n\nResults:\n${hResults.join('\n')}`);
            } else {
                alert('No systems loaded! Check console for errors.');
            }
        }
    </script>
</body>
</html>
